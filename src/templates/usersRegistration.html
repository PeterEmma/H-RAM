<html>
<head>
<title> Users Registration </title>
{% load staticfiles %}
	<link type="text/css" rel="stylesheet" href="{%  static 'src/bootstrap.min.css' %}">
<style>
	body {
    background-image: url("{% static 'src/background.jpg'%}");
}
.buttonz input[type=submit]{
  width: 10%;
  height: auto;
  background: #0df;
  border: 1px solid #fff;
  cursor: pointer;
  border-radius: 2px;
  color: #000;
  font-family: Copperplate, 'Copperplate Gothic Light', fantasy;
  font-size: 100%;
  font-weight: 400;
  padding: 0.5%;
}
select{
	height:24px;
}
input{
	width:auto;
	height:auto;
}

.buttonz input[type=submit]:hover {
	text-shadow: 0 0 10px rgba(255,255,255,1) , 0 0 20px rgba(255,255,255,1) , 0 0 30px rgba(255,255,255,1) , 0 0 40px #0000ff , 0 0 70px #0000ff , 0 0 80px #0000ff , 0 0 100px #00f ;
}

.buttonz input[type=submit]:active {
	opacity: 0.6;
}
</style>
</head>
<script type="text/javascript">
	function emptyAllInputs()
	{
		document.getElementById("rollno").value = "";
		document.getElementById("username").value = "";
		document.getElementById("password1").value = "";
		document.getElementById("password2").value = "";
		document.getElementById("email").value = "";
		//document.getElementById("hostel").value = "";
	}
	
	function validateRoll()
	{
		var r = document.getElementById("rollno").value;
		var regex = /^([0-9]{4}[A-Za-z]{2}[0-9]{2,3})$/;
		validroll = regex.test(r);
		if(!validroll)
		{
			document.getElementById("errorRoll").innerHTML = "Please enter a valid rollnumber";
			return false;
		}
		if(r.length == 0)
		{
			document.getElementById("errorRoll").innerHTML = "This field is required";
			return false;
		}
		document.getElementById("errorRoll").innerHTML = "";
		return true;
	}
	function checkRoll()
	{
		var r = document.getElementById("rollno").value;
		var regex = /^([A-Za-z0-9])*$/;
		valid = regex.test(r);
		if(!valid)
		{
			document.getElementById("errorRoll").innerHTML = "Please enter a valid rollnumber";
		}
		else
		{
			document.getElementById("errorRoll").innerHTML = "";	
		}
	}
	function validateName()
	{
		var s = document.getElementById("username").value;
		var regex = /^([A-Za-z0-9. ])*$/;
		valid = regex.test(s);
		if (!valid)
		{
			document.getElementById("errorUsername").innerHTML = "Please enter a valid username";
			return false;
		}
		if(s.length == 0)
		{
			document.getElementById("errorUsername").innerHTML = "This field is required";
			return false;
		}
		document.getElementById("errorUsername").innerHTML = "";
		return true;
	}
	function checkName()
	{
		var s = document.getElementById("username").value;
		var regex = /^([A-Za-z0-9. ])*$/;
		valid = regex.test(s);
		if (!valid)
		{
			document.getElementById("errorUsername").innerHTML = "Please enter a valid username";
		}
		else
		{
			document.getElementById("errorUsername").innerHTML = "";
		}
		
	}
	function validatePassword1()
	{
		var pass = document.getElementById('password1').value;
		if(pass.length == 0)
		{
			document.getElementById("errorPassword1").innerHTML = "This field is required";
			return false;
		}
		if(pass.length < 8)
		{
			return false;
		}
		return true;
	}
	function checkPassword1()
	{
		var pass = document.getElementById('password1').value;
		if(pass.length >= 0 && pass.length < 8)
		{
			document.getElementById("errorPassword1").innerHTML = "Weak Password";
		}
		if(pass.length >= 8)
		{
			document.getElementById("errorPassword1").innerHTML = "<font style=\"color:#006600;\">Strong Password</font>";
		}
	}
	function validatePassword2()
	{
		var pass = document.getElementById('password2').value;
		if(pass == document.getElementById('password1').value)
		{
			document.getElementById("errorPassword2").innerHTML = "<font style=\"color:#006600;\">Passwords Matched</font>";
			return true;
		}
		else
		{
			document.getElementById("errorPassword2").innerHTML = "Passwords didn't match";
			return false;
		}
	}
	function checkPassword2()
	{
		var pass = document.getElementById('password2').value;
		if(pass == document.getElementById('password1').value)
		{
			document.getElementById("errorPassword2").innerHTML = "<font style=\"color:#006600;\">Passwords Matched</font>";
		}
	}
	function validateHostel()
	{
		var s = document.getElementById("hostel").value;
		var regex = /^([A-Za-z0-9. ])*$/;
		valid = regex.test(s);
		if (!valid)
		{
			document.getElementById("errorHostel").innerHTML = "Please enter a valid Hostel name";
			return false;
		}
		if(s.length == 0)
		{
			document.getElementById("errorHostel").innerHTML = "This field is required";
			return false;
		}
		document.getElementById("errorHostel").innerHTML = "";
		return true;
	}
	function checkHostel()
	{
		var s = document.getElementById("hostel").value;
		var regex = /^([A-Za-z0-9. ])*$/;
		valid = regex.test(s);
		if (!valid)
		{
			document.getElementById("errorHostel").innerHTML = "Please enter a valid Hostel name";
		}
		else
		{
			document.getElementById("errorHostel").innerHTML = "";
		}
		
	}
	function validateEmail()
	{
		var s = document.getElementById("email").value;
		var regex = /^([A-Za-z0-9._%+-]+@iitp.ac.in)$/;
		valid = regex.test(s);
		if (valid)
		{
			document.getElementById("errorEmail").innerHTML = "";
			return true;
		}
		else
		{
			document.getElementById("errorEmail").innerHTML = "Please enter a valid email id";
			return true;
		}
	}
	function submitform()
	{
		if(validateRoll() && validateName() && validatePassword1() && validatePassword2() && validateEmail())
		{
			document.getElementById("form").submit();
		}
		else
		{
			document.getElementById("errors").innerHTML = "Please correct the errors and then submit";
		}
	}
</script>
<body onload="emptyAllInputs()">
	<p id="test"></p>
	<div class="container">

		<div class="row">
			<div class="col-md-12">
				<h1 class="text-center">Users Registration</h1>
			</div>
		</div>

		<hr>

		<div class="row">
			<div class="col-md-12 text-center" style="color:red; height:10%;">
				<div id="errors">
				{{errors|unordered_list}}
				</div>
			</div>
		</div>

		<form action="/administrator/check_valid_users/" method="POST" id="form">
			<div class="row">
				<div class="col-md-4 col-xs-4">
					<h4 class="text-right">User's RollNo</h4>
				</div>
				<div class="col-md-3 col-xs-3 text-left">
					<input type="text" id = "rollno" name="rollno" onblur="validateRoll()" onkeyup="checkRoll()">
				</div>
				<div class="col-md-3 col-xs-3 text-left" id="errorRoll"style="color:red;">
				</div>
			</div>
			<div class="row">
				<div class="col-md-4 col-xs-4">
					<h4 class="text-right">User's username</h4>
				</div>
				<div class="col-md-3 col-xs-3 text-left">
					<input type="text" id = "username" name="username" onblur="validateName()" onkeyup="checkName()">
				</div>
				<div class="col-md-3 col-xs-3 text-left" id="errorUsername" style="color:red;">
				</div>
			</div>
			<div class="row">
				<div class="col-md-4 col-xs-4">
					<h4 class="text-right">Password</h4>
				</div>
				<div class="col-md-3 col-xs-3 text-left">
					<input type="text" id = "password1" onselect="clearError()" onblur="validatePassword1()" onkeyup="checkPassword1()" name="password1">
				</div>
				<div class="col-md-3 col-xs-3 text-left" id="errorPassword1" style="color:red;">
				</div>
			</div>
			<div class="row">
				<div class="col-md-4 col-xs-4">
					<h4 class="text-right">Re-type Password</h4>
				</div>
				<div class="col-md-3 col-xs-3 text-left">
					<input type="text" id = "password2" onselect="clearError()" onblur="validatePassword2()" onkeyup="checkPassword2()" name="password2">
				</div>
				<div class="col-md-3 col-xs-3 text-left" id="errorPassword2" style="color:red;">
				</div>
			</div>
			<div class="row">
				<div class="col-md-4 col-xs-4">
					<h4 class="text-right">Email id</h4>
				</div>
				<div class="col-md-3 col-xs-3 text-left">
					<input type="text" id = "email" onselect="clearError()" onblur="validateEmail()" name="email">
				</div>
				<div class="col-md-3 col-xs-3 text-left" id="errorEmail" style="color:red;">
				</div>
			</div>

			<div class="row">
				<div class="col-md-4 col-xs-4">
					<h4 class="text-right">Hostel</h4>
				</div>
				<div class="col-md-3 col-xs-3 text-left">
					{% if hostels %}
				<select type="text" name = "hostel" id="hostel">
					{% for hostel in hostels %}
						<option value = "{{hostel}}">	{{hostel}}
						</option>
					{% endfor %}
				</select>
				{% endif %}
				</div>
			</div>

			<!--<div class="row">
				<div class="col-md-4 col-xs-4">
					<h4 class="text-right">Hostel Alloted</h4>
				</div>
				<div class="col-md-3 col-xs-3 text-left">
					<input type="text" id = "hostel" onselect="clearError()" onblur="validateHostel()" onkeyup="checkHostel()" name="supporter2">
				</div>
				<div class="col-md-3 col-xs-3 text-left" id="errorHostel" style="color:red;">
				</div>
			</div>-->
			<div class="row">
				<div class="col-md-12 text-center col-xs-12" >
					<div class="buttonz"><input type="button" onclick="submitform()" value="submit"></div>
				</div>
			</div>
			
		</form>
	</div>
</body>
</html>
